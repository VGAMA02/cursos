if (self.CavalryLogger) { CavalryLogger.start_js(["W5xlsDN"]); }

__d("StoriesTrayTileVideoAutoPlayerWrapper_video.graphql",[],(function(a,b,c,d,e,f){"use strict";a={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoriesTrayTileVideoAutoPlayerWrapper_video",selections:[{args:[{kind:"Literal",name:"playerSuborigin",value:"stories_video_preview"}],kind:"FragmentSpread",name:"VideoPlayerRelayWithSSR_video"},{alias:null,args:null,kind:"ScalarField",name:"viewer_autoplay_setting",storageKey:null}],type:"Video",abstractKey:null};e.exports=a}),null);
__d("StoriesTrayTileVideoAutoPlayerSurface.react",["VideoPlayerHooks","VideoPlayerSurface.react","VideoPlayerWithThumbnail.react","react"],(function(a,b,c,d,e,f,g){"use strict";var h=d("react");b=d("react");var i=b.useEffect,j=b.useRef,k=b.useState,l=3;function a(a){var b=a.coverImage,e=a.onPlaybackEnded;a=k(0);var f=a[0],g=a[1],m=j(null),n=d("VideoPlayerHooks").useController(),o=d("VideoPlayerHooks").useVideoPlayerTotalLoops();i(function(){m.current=n.getPlayheadPosition();var a=n.subscribe(function(){var a=m.current,b=n.getPlayheadPosition(),c=n.getCurrentState();if(a!=null&&b!==a&&!c.seeking){m.current=b;a=Math.min(c.duration,l);b>=a?(n.seek(0),o>-1&&f>=o?(n.pause("product_initiated"),n.freeze(),e()):g(f+1)):b<0&&n.seek(0)}});return function(){a.remove(),m.current=null}},[n,f,e,o]);return h.jsx(c("VideoPlayerSurface.react"),{children:h.jsx(c("VideoPlayerWithThumbnail.react"),{src:b})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);
__d("StoriesTrayTileVideoAutoPlayerWrapper.react",["CometBackgroundImage.react","CometPlaceholder.react","CometRelay","StoriesTrayTileVideoAutoPlayerSurface.react","StoriesTrayTileVideoAutoPlayerWrapper_video.graphql","VideoPlayerWithThumbnail.react","deferredLoadComponent","qex","react","requireDeferred"],(function(a,b,c,d,e,f,g){"use strict";var h,i=d("react");e=d("react");var j=e.useCallback,k=e.useState,l=c("deferredLoadComponent")(c("requireDeferred")("VideoPlayerRelayWithSSR.react").__setRef("StoriesTrayTileVideoAutoPlayerWrapper.react"));function a(a){var e=a.coverImage;a=a.video;a=d("CometRelay").useFragment(h!==void 0?h:h=b("StoriesTrayTileVideoAutoPlayerWrapper_video.graphql"),a);var f=k(!1),g=f[0],m=f[1];f=j(function(){m(!0)},[]);var n=j(function(){return i.jsx(c("VideoPlayerWithThumbnail.react"),{src:e})},[e]);if(a.viewer_autoplay_setting==="off"||g)return i.jsx(c("CometBackgroundImage.react"),{src:e});g=((g=c("qex")._("804"))!=null?g:!0)?(g=c("qex")._("805"))!=null?g:3:null;return i.jsx(c("CometPlaceholder.react"),{fallback:i.jsx(c("CometBackgroundImage.react"),{src:e}),children:i.jsx(l,{bufferEndLimit:g,canAutoplay:"respect_user_settings",disableLoadingIndicator:!0,errorBoundaryFallback:function(){return i.jsx(c("CometBackgroundImage.react"),{src:e})},loopCount:2,portalingEnabled:!1,portalingRenderPlaceholder:n,silenceHydrationMutationReporting:!0,subOrigin:"stories_video_preview",video:a,volumeSetting:0,children:i.jsx(c("StoriesTrayTileVideoAutoPlayerSurface.react"),{coverImage:e,onPlaybackEnded:f})})})}a.displayName=a.name+" [from "+f.id+"]";g["default"]=a}),98);